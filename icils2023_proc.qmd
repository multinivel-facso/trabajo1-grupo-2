---
title: "ICILS2023_proc"
format: html
editor: visual
---

# ¿Mayor acceso significa mayor autoeficacia? Un análisis de la autoeficacia digital general y específica a lo largo de 35 países.

En términos de contenidos, para el informe de avance se espera un reporte de alrededor de 2000 palabras que sea una especie de borrador del informe final. El énfasis de esta primera entrega se encuentra en el planteamiento del problema y preguntas de investigación en una lógica multinivel, descripción de los datos, estimación de correlación intra-clase, efectos aleatorios y modelos preliminares. En la segunda entrega se complementan los análisis con temas de interacciones entre niveles, evaluación de ajuste, centrado de variables y análisis de casos influyentes.

En esta investigación se busca determinar el efecto que el acceso a TIC en el hogar y en la escuela de los estudiantes tiene sobre su autoeficacia digital, tanto general como específica. La autoeficacia es un concepto desarrollado por Bandura (1995), que describe la actitud de un individuo hacia sus capacidades frente a un potencial evento futuro. Una persona autoeficaz (o más precisamente con un alto nivel de autoeficacia) es aquella que se considera capaz de reorganizar sus habilidades para masterizar un atributo que no domina en el momento. Ulfert-Blank y Schmidt (2022) sostienen que la autoeficacia es una de las determinantes del uso competente del uso de tecnología digital, pues esta actitud cobra gran relevancia en las sociedades actuales, marcadas por la transformación tecnológica constante. Áreas como el trabajo o la educación exigen rápidamente nuevas habilidades de uso de tecnología para desempeñarse efectivamente.

La premisa del estudio es que el efecto de la infraestructura TIC en el hogar y la infraestructura TIC de la escuela no sólo afectan la autoeficacia digital de los jóvenes, sino que adicionalmente el nivel de la infraestructura TIC del hogar modula el efecto de la infraestructura TIC de la escuela sobre la autoeficacia.

La pregunta de investigación es: ¿De qué manera el acceso que los jóvenes de 35 países tienen a las TIC, tanto en su hogar como en su escuela, influye en su autoeficacia general y específica?

Las hipótesis a testear son las siguientes:

H1: Los estudiantes con mayor acceso a TIC en su hogar presentarán mayores niveles de autoeficacia general y autoeficacia específica.

H2: La infraestructura TIC de las escuelas tendrá un efecto positivo en la autoeficacia general y específica de los estudiantes.

H3: El efecto de la infraestructura TIC de la escuela en la autoeficacia general y específica es moderada por el acceso a TIC en el hogar.

Se trabajará con datos de ICILS (International Computer and Information Literacy Study), una encuesta que levanta datos sobre la alfabetización computacional e informacial (CIL) de estudiantes en 609 escuelas de 35 paises distintos. ICILS fue creada para medir diferencias entre paises en este respecto, y pone especial interés en la medición de la capacidad de los estudiantes para desenvolverse con soltura en el mundo digital. Los estudiantes que responden ICILS están en su octavo año de enseñanza escolar, pero en sistemas educativos donde la edad promedio está debajo de 13,5 años se encuesta estudiantes de noveno año.

Las variables seleccionadas para este estudio fueron: "CNTRY" (código del país), "IDSCHOOL" (ID único de la escuela), "S_HOMLIT" (índice de alfabetización del hogar), "S_SEX" (sexo del/la estudiante), "S_AGE" (edad del/la estudiante), "S_ICTPOSG" (percepción positiva del estudiante hacia las TICs), "S_ICTNEG" (percepción negativa del estudiante hacia las TICs), "S_GENEFF" (autoeficacia digital general), "S_SPECEFF" (autoeficacia digital específica), "IS3G16BA" (acceso de computador en casa para tareas), "IS3G16BB" (acceso de tablets en casa para tareas), "IS3G16BC" (acceso de smartphones en casa) y "S_INTNET" (calidad del internet en casa).

Las variables dependientes del estudio son las de autoeficacia digital. Las variablesde de acceso de computador, tablets, smartphones e internet en el hogar se usaron para construir un índice de acceso a TIC en el hogar. Las variables de infraestructura TIC en la escuela, así como su interacción con el nivel individual, serán incorporadas en el próximo avance.

### Cargamos los paquetes a utilizar

```{r}
library(pacman)
p_load(dplyr, haven, lme4, summarytools, tidyverse, sjPlot, corrplot, reghelper)
options(scipen = 999) 
rm(list = ls())      
```

### Cargamos y unimos las bases de datos directamente

```{r}
# Obtener la lista de archivos que comienzan con "BSG" y terminan con ".Rdata"
archivos_bsg <- list.files(
  path = "./ICILS2023_IDB_R/Data", # Directorio actual
  pattern = "^BSG.*\\.Rdata$",
  full.names = TRUE
)

# Ver qué archivos encontramos
print(archivos_bsg)

# Inicializar una lista vacía para almacenar temporalmente los dataframes
temp_dataframes <- list()

# Cargar cada archivo y añadirlo a la lista
for (archivo in archivos_bsg) {
  # Crea un entorno temporal para cargar el archivo
  temp_env <- new.env()
  # Carga el archivo en el entorno temporal
  load(archivo, envir = temp_env)
  
  # Identifica el nombre del dataframe en el entorno temporal
  nombres_objetos <- ls(temp_env)
  for (nombre in nombres_objetos) {
    objeto <- get(nombre, envir = temp_env)
    # Verifica si es un data frame y si el nombre comienza con BSG
    if (is.data.frame(objeto) && grepl("^BSG", nombre)) {
      # Añade el dataframe a nuestra lista
      temp_dataframes[[length(temp_dataframes) + 1]] <- objeto
    }
  }
}

# Combina todos los dataframes en uno solo
datos_combinados_bsg <- bind_rows(temp_dataframes)

# Ver el resultado
dim(datos_combinados_bsg)  # Dimensiones del data frame combinado
```

#### Eliminar objetos del entorno

```{r}
# Guardamos el nombre del objeto que queremos mantener
objeto_a_mantener <- "datos_combinados_bsg"

# Obtenemos todos los objetos en el entorno actual
todos_los_objetos <- ls()

# Creamos una lista de objetos a eliminar (todos excepto datos_combinados)
objetos_a_eliminar <- todos_los_objetos[todos_los_objetos != objeto_a_mantener]

# Eliminamos los objetos que no necesitamos
rm(list = objetos_a_eliminar)

# Verificamos que solo queda el dataframe combinado
print(ls())
```

### Selección de variables relevantes

```{r}
# Vector con todas las variables de interés
variables_seleccionadas <- c(
  # Variables esenciales
  "CNTRY", # El código del país (tres letras)
  "IDSCHOOL", # id único de la escuela
  
  # Variables SES, demográficas y TIC
  "S_HOMLIT", # Home literacy index
  "S_SEX", # Sexo del/la estudiante
  "S_AGE", # Edad del/la estudiante

  # Variables del estudio
  
  "S_ICTPOSG", # Students' perceptions of ICT - positive beliefs about ICT and society
  "S_ICTNEG", # Students' perceptions of ICT - negative beliefs about ICT and society
  "S_GENEFF",
  "S_SPECEFF",

  # Variables índice
  
  "IS3G16BA", # Acceso de computador en casa para tareas (escritorio o laptop). Rango: 1 a 4 (nunca a siempre)
  "IS3G16BB", # Acceso de tablets en casa para tareas. Rango: 1 a 4 (nunca a siempre)
  "IS3G16BC", # Acceso de smartphones en casa (escritorio o laptop) Rango: 1 a 4 (nunca a siempre)
  "S_INTNET" # Internet en casa si/no
)

# Seleccionar solo las columnas que existen en el dataframe
datos_analisis <- datos_combinados_bsg %>%
  select(any_of(variables_seleccionadas))
```

### Creación del índice de acceso a TICs

```{r}
#pregunta 1: efecto de acceso TIC en hogar en Actitud hacia las TIC
datos_analisis <- datos_analisis %>%
  na.omit() %>%
  mutate(across(.cols = -CNTRY, .fns = ~as.numeric(.)))


datos_analisis <- datos_analisis %>%
  mutate(
    acceso_TIC_intnet = (
      ((IS3G16BA - 1) * (1/3)) +
      ((IS3G16BB - 1) * (1/3)) + 
      ((IS3G16BC - 1) * (1/3)) + 
      (S_INTNET) # S_INTNET ya está en la escala deseada (0-1)
     ) / 4
   )


```

### Modelo multivariado

```{r}

multivariate_model <- lm(S_ICTPOSG ~ acceso_TIC_intnet, data = datos_analisis)

```

```{r}

summary_model <- summary(multivariate_model)
print(summary_model)

```

### Modelos nulos multinivel

```{r}

results_0_gen_sch = lmer(S_GENEFF ~ 1 + (1 | IDSCHOOL), data = datos_analisis)
results_0_spec_sch = lmer(S_SPECEFF ~ 1 + (1 | IDSCHOOL), data = datos_analisis)

print(reghelper::ICC(results_0_gen_sch))

print(reghelper::ICC(results_0_spec_sch))
```

La variación de la autoeficacia general dependiente del nivel escuela es de 0.2%. y la de la autoeficacia específica corresponde a 1.7%. Este resultado es considerado bajo, apuntando a un efecto pequeño de las variables de anidación y uno amplio de los individuos. Sin embargo, considerando que la autoeficacia es una actitud dependiente de múltiples factores asociados a un sujeto, se decide seguir con el estudio para modelar el efecto de variables de acceso a nivel individual y escolar en la autoeficacia.

### Cargamos las variables de escuela

Nota: las variables del cuestionario de teachers usualmente se usan como nivel de escuela

```{r}
# Obtener la lista de archivos que comienzan con "BCG" y terminan con ".Rdata"
archivos_bcg <- list.files(
  path = "./ICILS2023_IDB_R/Data", # Directorio actual (cambia si es necesario)
  pattern = "^BCG.*\\.Rdata$",
  full.names = TRUE
)

# Ver qué archivos encontramos
print(archivos_bcg)

# Inicializar una lista vacía para almacenar temporalmente los dataframes
temp_dataframes <- list()

# Cargar cada archivo y añadirlo a la lista
for (archivo in archivos_bcg) {
  # Crea un entorno temporal para cargar el archivo
  temp_env <- new.env()
  # Carga el archivo en el entorno temporal
  load(archivo, envir = temp_env)
  
  # Identifica el nombre del dataframe en el entorno temporal
  nombres_objetos <- ls(temp_env)
  for (nombre in nombres_objetos) {
    objeto <- get(nombre, envir = temp_env)
    # Verifica si es un data frame y si el nombre comienza con BCG
    if (is.data.frame(objeto) && grepl("^BCG", nombre)) {
      # Añade el dataframe a nuestra lista
      temp_dataframes[[length(temp_dataframes) + 1]] <- objeto
    }
  }
}

# Combina todos los dataframes en uno solo
datos_combinados_bcg <- bind_rows(temp_dataframes)

# Ver el resultado
dim(datos_combinados_bcg)  # Dimensiones del data frame combinado
```

```{r}
# Vector con todas las variables de interés
variables_seleccionadas <- c(
  "IDSCHOOL", 
  "IP3G05", #Tamaño lugar escuela (rural o ciudad, población)
  "IP3G10C", #Student access to school computers outside class hours during school
  "IP3G06BA", #Percentage of students with socio-economic background/affluent homes
  "IP3G06BB", #Percentage of students with socio-economic background/disadvantaged homes
  "IP3G10B", #Restrictions on allowed time to spend on computer
  "IP3G10C", #Student access to school computers outside class hours during school
  "IP3G10D", #Student access to school computers outside school hours
  #Mirar variables de Availability II3G0 (4, 5, 6 y 7)"
  "CRATSTD",
)

# Seleccionar solo las columnas que existen en el dataframe
datos_analisis <- datos_combinados_bcg %>%
  select(any_of(variables_seleccionadas))

# Mostrar información del resultado
cat("Variables encontradas:", ncol(datos_analisis), "de", length(variables_seleccionadas), "\n")
```

```{r}
library(sjPlot)
 
multilevel_model <- lmer(
  S_ICTPOSG 
  ~ acceso_TIC_intnet 
  #+ S_SEX 
  #+ S_EXCOMP 
  #+ S_ISCED  
  + (1 | IDSCHOOL), data = datos_analisis)


combined_table <- tab_model(
  multivariate_model,
  multilevel_model,
  #show.ci = 0.95,       # Mostrar ICs
  #show.p = TRUE,        # Mostrar valores p
  #auto.label = TRUE,    # Intentar usar nombres de variables directamente
  #show.r2 = TRUE,       # Mostrar R2 (aplica de forma diferente a cada modelo)
  show.icc = TRUE,      # Mostrar ICC (solo relevante para multinivel)
  show.re.var = TRUE,   # Mostrar varianzas aleatorias (solo relevante para multinivel)
  title = "Tabla Comparativa: Modelo Multivariado y Modelo Multinivel" # Título opcional
)

combined_table
```

## Bibliografía

Bandura, A. (Ed.). (1995). *Self-efficacy in changing societies* (pp. xv, 334). New York, NY, US: Cambridge University Press. <https://doi.org/10.1017/CBO9780511527692>

Ulfert-Blank, A. S., & Schmidt, I. (2022). Assessing digital self-efficacy: Review and scale development. *Computers & Education*, *191*, 104626.
